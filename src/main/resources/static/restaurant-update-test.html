<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Update Test</title>
    <style>
        .form-section {
            margin-bottom: 20px;
        }
        .form-section h3 {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
<h1>Update Restaurant</h1>
<form id="updateForm">
    <div class="form-section">
        <h3>Basic Information</h3>
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br><br>

        <label for="address">Address:</label>
        <input type="text" id="address" name="address" required><br><br>

        <label for="information">Information:</label>
        <textarea id="information" name="information" required></textarea><br><br>

        <label for="contact_number">Contact Number:</label>
        <input type="text" id="contact_number" name="contact_number" required><br><br>
    </div>

    <div class="form-section">
        <h3>Images</h3>
        <label for="restaurantImages">Restaurant Images:</label>
        <input type="file" id="restaurantImages" name="restaurantImages" multiple><br><br>

        <label for="menuImages">Menu Images:</label>
        <input type="file" id="menuImages" name="menuImages" multiple><br><br>
    </div>

    <div class="form-section">
        <h3>Opening Hours</h3>
        <div id="openingHours">
            <div>
                <label>Day:</label>
                <select name="dayOfWeek">
                    <option value="MONDAY">Monday</option>
                    <option value="TUESDAY">Tuesday</option>
                    <option value="WEDNESDAY">Wednesday</option>
                    <option value="THURSDAY">Thursday</option>
                    <option value="FRIDAY">Friday</option>
                    <option value="SATURDAY">Saturday</option>
                    <option value="SUNDAY">Sunday</option>
                </select>
                <label>Open At:</label>
                <input type="time" name="openAt">
                <label>Close At:</label>
                <input type="time" name="closeAt">
            </div>
        </div>
        <button type="button" onclick="addOpeningHour()">Add Opening Hour</button>
    </div>

    <div class="form-section">
        <h3>Break Hours</h3>
        <div id="breakHours">
            <div>
                <label>Day:</label>
                <select name="dayOfWeek">
                    <option value="MONDAY">Monday</option>
                    <option value="TUESDAY">Tuesday</option>
                    <option value="WEDNESDAY">Wednesday</option>
                    <option value="THURSDAY">Thursday</option>
                    <option value="FRIDAY">Friday</option>
                    <option value="SATURDAY">Saturday</option>
                    <option value="SUNDAY">Sunday</option>
                </select>
                <label>Break Start:</label>
                <input type="time" name="breakStart">
                <label>Break End:</label>
                <input type="time" name="breakEnd">
            </div>
        </div>
        <button type="button" onclick="addBreakHour()">Add Break Hour</button>
    </div>

    <div class="form-section">
        <h3>Amenities</h3>
        <div id="amenities">
            <input type="text" name="amenity" placeholder="Amenity Name">
        </div>
        <button type="button" onclick="addAmenity()">Add Amenity</button>
    </div>

    <div class="form-section">
        <h3>Keywords</h3>
        <div id="keywords">
            <input type="text" name="keyword" placeholder="Keyword Name">
        </div>
        <button type="button" onclick="addKeyword()">Add Keyword</button>
    </div>

    <div class="form-section">
        <h3>Menu Items</h3>
        <div id="menuItems">
            <div>
                <input type="text" name="menuName" placeholder="Menu Name">
                <input type="text" name="menuPrice" placeholder="Price">
                <textarea name="menuDescription" placeholder="Description"></textarea>
                <label>Recommendation:</label>
                <input type="checkbox" name="recommendation">
            </div>
        </div>
        <button type="button" onclick="addMenuItem()">Add Menu Item</button>
    </div>

    <button type="button" onclick="submitForm()">Submit</button>
</form>

<script>
    function addOpeningHour() {
        const openingHours = document.getElementById('openingHours');
        const newHour = openingHours.children[0].cloneNode(true);
        openingHours.appendChild(newHour);
    }

    function addBreakHour() {
        const breakHours = document.getElementById('breakHours');
        const newHour = breakHours.children[0].cloneNode(true);
        breakHours.appendChild(newHour);
    }

    function addAmenity() {
        const amenities = document.getElementById('amenities');
        const newAmenity = amenities.children[0].cloneNode(true);
        newAmenity.value = '';
        amenities.appendChild(newAmenity);
    }

    function addKeyword() {
        const keywords = document.getElementById('keywords');
        const newKeyword = keywords.children[0].cloneNode(true);
        newKeyword.value = '';
        keywords.appendChild(newKeyword);
    }

    function addMenuItem() {
        const menuItems = document.getElementById('menuItems');
        const newItem = menuItems.children[0].cloneNode(true);
        newItem.querySelectorAll('input, textarea').forEach(input => input.value = '');
        menuItems.appendChild(newItem);
    }

    function submitForm() {
        const formData = new FormData(document.getElementById('updateForm'));
        const data = {
            name: formData.get('name'),
            address: formData.get('address'),
            information: formData.get('information'),
            contact_number: formData.get('contact_number'),
            restaurantImageList: [],
            openingHourList: [],
            breakHourList: [],
            restaurantAmenityRequestList: [],
            restaurantKeywordRequestList: [],
            menuItemRequestList: []
        };

        // Collect opening hours
        document.querySelectorAll('#openingHours > div').forEach(div => {
            const dayOfWeek = div.querySelector('select[name="dayOfWeek"]').value;
            const openAt = div.querySelector('input[name="openAt"]').value;
            const closeAt = div.querySelector('input[name="closeAt"]').value;
            data.openingHourList.push({ dayOfWeek, openAt, closeAt });
        });

        // Collect break hours
        document.querySelectorAll('#breakHours > div').forEach(div => {
            const dayOfWeek = div.querySelector('select[name="dayOfWeek"]').value;
            const breakStart = div.querySelector('input[name="breakStart"]').value;
            const breakEnd = div.querySelector('input[name="breakEnd"]').value;
            data.breakHourList.push({ dayOfWeek, breakStart, breakEnd });
        });

        // Collect amenities
        document.querySelectorAll('#amenities > input').forEach(input => {
            data.restaurantAmenityRequestList.push({ amenity: { name: input.value } });
        });

        // Collect keywords
        document.querySelectorAll('#keywords > input').forEach(input => {
            data.restaurantKeywordRequestList.push({ keyword: { name: input.value } });
        });

        // Collect menu items
        document.querySelectorAll('#menuItems > div').forEach(div => {
            const name = div.querySelector('input[name="menuName"]').value;
            const price = div.querySelector('input[name="menuPrice"]').value;
            const description = div.querySelector('textarea[name="menuDescription"]').value;
            const recommendation = div.querySelector('input[name="recommendation"]').checked;
            data.menuItemRequestList.push({ name, price, description, recommendation });
        });

        formData.append('data', JSON.stringify(data));

        fetch('/api/restaurant/all/1', { // Replace '1' with the actual restaurant ID
            method: 'PUT',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            console.log('Success:', data);
            alert('Restaurant updated successfully!');
        })
        .catch((error) => {
            console.error('Error:', error);
            alert('Error updating restaurant.');
        });
    }
</script>
</body>
</html>